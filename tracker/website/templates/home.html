{% extends 'base.html' %}

{% block content %}
{% if user.is_authenticated %}
<div class="container mt-5">
    <div class="card shadow p-3 mb-4">
        <h2 class="text-center mb-4">Survey Project Overview</h2>
        <div class="row text-center">

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h5>Total Projects</h5>
                    <h2>{{ total }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Overlapping Clearance</h6>
                    <h2>{{ overlapping }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Parceling Stage</h6>
                    <h2>{{ parceling }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>GIS Post</h6>
                    <h2>{{ gis_post }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Survey Tool Access</h6>
                    <h2>{{ tool_access }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Survey Stage</h6>
                    <h2>{{ survey_stage }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Cluster ID Acquisition</h6>
                    <h2>{{ cluster_id }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>HLD Submission</h6>
                    <h2>{{ hld_submission }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>HLD Approval</h6>
                    <h2>{{ hld_approval }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Completed</h6>
                    <h2>{{ completed }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>For Cancellation</h6>
                    <h2>{{ for_cancellation }}</h2>
                </div>
            </div>

            <div class="col-md-3 mb-3">
                <div class="card shadow-sm p-3">
                    <h6>Cancelled</h6>
                    <h2>{{ cancelled }}</h2>
                </div>
            </div>

        </div>
    </div>

    <!-- Pie Chart -->
    <div class="card shadow p-4">
        <h4 class="text-center">Tools Stage Distribution</h4>
        <canvas id="statusPieChart" style="max-height: 350px;"></canvas>
    </div>
</div>

<!-- Chart.js CDN -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
    const ctx = document.getElementById('statusPieChart').getContext('2d');

    new Chart(ctx, {
        type: 'pie',
        data: {
            labels: [
                'Overlapping', 'Parceling', 'GIS Post', 'Tool Access',
                'Survey Stage', 'Cluster ID', 'HLD Sub', 'HLD App',
                'Completed', 'For Cancellation', 'Cancelled'
            ],
            datasets: [{
                data: [
                    Number("{{ overlapping }}"), Number("{{ parceling }}"), Number("{{ gis_post }}"),
                    Number("{{ tool_access }}"), Number("{{ survey_stage }}"), Number("{{ cluster_id }}"),
                    Number("{{ hld_submission }}"), Number("{{ hld_approval }}"), Number("{{ completed }}"),
                    Number("{{ for_cancellation }}"), Number("{{ cancelled }}")
                ],
                backgroundColor: [
                    'rgba(255, 206, 86)',
                    'rgba(75, 192, 192)',
                    'rgba(255, 99, 132)',
                    'rgba(54, 162, 235)',
                    'rgba(201, 203, 207)',
                    'rgba(153, 102, 255)',
                    'rgba(255, 159, 64)',
                    'rgba(99, 255, 132)',
                    'rgba(16, 185, 129)',
                    'rgba(255, 159, 64)',
                    'rgba(200, 50, 50)'
                ]
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { position: 'bottom' } }
        }
    });
</script>

{% else %}
<div class="container text-center mt-5">
    <h1 class="display-5 fw-bold">Telecom Project Tracker</h1>
    <p class="lead mt-3">A centralized platform for managing telecom construction projects from planning to invoicing.
    </p>
</div>

<div class="container mt-5">
    <div class="row text-center">
        <div class="col-md-4">
            <h5>üìç Track Work Progress</h5>
            <p>Monitor the status of telecom construction stages such as HLD, LLD, Implementation, DCR, and Invoice.</p>
        </div>
        <div class="col-md-4">
            <h5>üìÇ Organized Documentation</h5>
            <p>Store project details, deliverables, and approvals in one secure platform.</p>
        </div>
        <div class="col-md-4">
            <h5>üìä Real-time Status</h5>
            <p>Stay updated with accurate progress monitoring and reduce manual reporting.</p>
        </div>
    </div>
</div>
<div class="container mt-5 text-center">
    <h3>Built for Telecom Construction Teams</h3>
    <p>Streamline your workflow, reduce errors, and improve project visibility across all phases.</p>
</div>
<div class="text-center mt-4 mb-5">
    <a href="{% url 'register' %}" class="btn btn-outline-success btn-lg px-5">Get Started</a>
</div>


<center>
    <footer class="footer fixed-bottom bg-light py-3">

        <p>Copyright ¬© 2025 JohnJabZ<br>

            This project is released as open source.
            Permission is hereby granted to use, copy, modify, merge, publish, distribute,
            sublicense, and/or sell copies of the software, subject to the inclusion of this
            copyright notice in all copies or substantial portions of the software.<br>

            THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
            IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
            FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
            AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
            LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
            OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
            SOFTWARE.

    </footer>
</center>
{% endif %}


{% endblock %}